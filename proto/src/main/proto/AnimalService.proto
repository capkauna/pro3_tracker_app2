syntax = "proto3";

option java_package = "slaughterhouse.assignment.grpc";
option java_multiple_files = true;

// -------------------- SERVICE --------------------

service AnimalService {

  // R1: Registers a new animal in the system.
  rpc AddAnimal(AnimalRegistrationRequest) returns (AnimalInfoResponse);

  // R2: Get single animal by registration number
  rpc GetAnimalByRegNo(GetAnimalByRegNoRequest) returns (AnimalInfoResponse);

  // R3: Get animals by origin
  rpc GetAnimalsByOrigin(GetAnimalsByOriginRequest) returns (AnimalListResponse);

  // R4: Get animals by registration date
  rpc GetAnimalsByDate(GetAnimalsByDateRequest) returns (AnimalListResponse);

  // R5: Mark animal as butchered
  rpc MarkAnimalAsButchered(MarkAnimalButchered) returns (AnimalInfoResponse);
}

// -------------------- MESSAGES --------------------

// Mirrors AnimalRegistrationRequestDTO
message AnimalRegistrationRequest {
  double weight = 1;
  string reg_no = 2;
  string origin = 3;
  // ISO-8601 date string: "YYYY-MM-DD"
  string date = 4;
}

// Mirrors AnimalInfoResponseDTO
message AnimalInfoResponse {
  int32 animal_id = 1;
  double weight = 2;
  string reg_no = 3;
  // ISO-8601 date string: "YYYY-MM-DD"
  string registration_date = 4;
  string origin = 5;
  bool is_butchered = 6;
}

// --- Request wrappers ---

message GetAnimalByRegNoRequest {
  string reg_no = 1;
}

message GetAnimalsByOriginRequest {
  string origin = 1;
}

message GetAnimalsByDateRequest {
  // ISO-8601 date string: "YYYY-MM-DD"
  string date = 1;
}

// --- List wrapper ---

message AnimalListResponse {
  repeated AnimalInfoResponse animals = 1;
}

// --- Mark butchered ---

message MarkAnimalButchered {
  int32 animal_id = 1;
}
