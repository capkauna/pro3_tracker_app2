syntax = "proto3";

option java_package = "slaughterhouse.assignment.grpc";
option java_multiple_files = true;


// --- Service Definition ---
//
// This service handles CRUD-like operations for Animals.
service AnimalService {

  // R1: Registers a new animal in the system.
  rpc AddAnimal(AnimalRegistrationRequest) returns (AnimalInfoResponse);

  // R2: Get a single animal by its registration number.
  rpc GetAnimalByRegNo(GetAnimalByRegNoRequest) returns (AnimalInfoResponse);

  // R3: Get all animals from a given origin.
  rpc GetAnimalsByOrigin(GetAnimalsByOriginRequest) returns (AnimalListResponse);

  // R4: Get all animals registered on a given date.
  rpc GetAnimalsByDate(GetAnimalsByDateRequest) returns (AnimalListResponse);

  // R5: Mark an animal as butchered.
  rpc MarkAnimalAsButchered(MarkAnimalButchered) returns (AnimalInfoResponse);
}

// --- Message Definitions ---

// Mirrors AnimalRegistrationRequestDTO
message AnimalRegistrationRequest {
  double weight = 1;
  string reg_no = 2;
  string origin = 3;
  string date = 4;
}

// Mirrors AnimalInfoResponseDTO
message AnimalInfoResponse {
  int32 animal_id = 1;
  double weight = 2;
  string reg_no = 3;
  string registration_date = 4;
  string origin = 5;
  bool is_butchered = 6;
}

// List of animals, used for queries that return multiple animals.
message AnimalListResponse {
  repeated AnimalInfoResponse animals = 1;
}

// --- Request Messages ---

// Request for GetAnimalByRegNo
message GetAnimalByRegNoRequest {
  string reg_no = 1;
}

// Request for GetAnimalsByOrigin
message GetAnimalsByOriginRequest {
  string origin = 1;
}

// Request for GetAnimalsByDate
message GetAnimalsByDateRequest {
  string date = 1;
}

// Request for MarkAnimalAsButchered
message MarkAnimalButchered {
  int32 animal_id = 1;
}

// NOTE: This AddAnimal message is not used anymore,
// you can safely delete it if you want.
// Keeping it here commented out so it does not break anything.
/*
message AddAnimal {
  int64 weight = 1;
  string reg_no = 2;
}
*/
